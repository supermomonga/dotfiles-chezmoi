# Generated by chezmoi — do not edit manually

# --- Vultr ---
{{- if env "VULTR_API_KEY" }}
{{- $vultrData := output "vultr-cli" "instance" "list" "--output=json" | fromJson }}
{{- range $vultrData.instances }}

Host {{ .label | kebabcase }}
    HostName {{ .main_ip }}
    Port 22
    User {{ if eq .user_scheme "root" }}root{{ else }}linuxuser{{ end }}
    ForwardAgent yes
    TCPKeepAlive yes
    PasswordAuthentication no
{{- end }}
{{- else }}
# VULTR_API_KEY is not set — no Vultr hosts generated
{{- end }}

# --- Contabo ---
{{- if lookPath "cntb" }}
{{- $cntbData := output "cntb" "get" "instances" "--output" "json" | fromJson }}
{{- range $cntbData }}

Host {{ .displayName | kebabcase }}
    HostName {{ .ipv4 }}
    Port 22
    User {{ .defaultUser }}
    ForwardAgent yes
    TCPKeepAlive yes
    PasswordAuthentication {{ if eq .defaultUser "root" }}yes{{ else }}no{{ end }}
{{- end }}
{{- else }}
# cntb is not available — no Contabo hosts generated
{{- end }}

# --- GreenCloud ---
{{- $op := "op" -}}
{{- if and (eq .chezmoi.os "linux") (.chezmoi.kernel.osrelease | lower | contains "microsoft") -}}
{{-   $op = "op.exe" -}}
{{- end -}}
{{- $gcApiKey := output $op "read" "op://Personal/GreenCloud VPS/api_key" "--no-newline" -}}
{{- $gcData := output "curl" "-sf" "https://cp.green.cloud/api/server" "-H" "Accept: application/json" "-H" (printf "Authorization: Bearer %s" $gcApiKey) | fromJson -}}
{{- range $gcData.data }}

Host {{ .name | kebabcase }}
    HostName {{ (index .network.primary.ipv4 0).address }}
    Port 22
    User main
    ForwardAgent yes
    TCPKeepAlive yes
{{- end }}
